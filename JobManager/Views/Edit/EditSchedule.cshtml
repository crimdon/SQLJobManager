
@{
    ViewBag.Title = "Edit Schedule";
}

@using JobManager.Models;

@model ScheduleDetailsModel

@section LeftMenu{
    @{Html.RenderAction("_LeftMenu", "Edit", new { dbServer = ViewBag.ServerName, jobID = ViewBag.JobID });
    }
}

<link href="@Url.Content("~/Content/jquery-ui-timepicker-addon.css")" rel="stylesheet">

@using (Html.BeginForm())
{
    <fieldset>
        <div class="section">
            <h3>Schedule</h3>
            <div class="editor-label">
                Name
            </div>
            <div class="editor-field">
                @Html.TextBoxFor(m => m.Name)
            </div>
            <br />
            <div class="editor-label">
                Schedule type
            </div>
            <div class="editor-field form-control-container text-left">
                @Html.DropDownListFor(m => m.FrequencyTypes, (List<SelectListItem>)ViewBag.FreqTypes, null, new { @onchange = "toggleOptionalDisplay(this.value)", @class = "form-control", @id = "freqtype", @style = "width:300px;" })
            </div>
            <br />
            <div class="editor-label">
                Enabled
            </div>
            <div class="editor-field">
                @Html.CheckBoxFor(m => m.IsEnabled)
            </div>
        </div>

        <div id="OneTime" class="section" hidden>
            <h5>One time</h5>
            <div class="editor-label">
                Date
            </div>
            <div class="editor-field">
                @Html.TextBoxFor(m => m.ActiveStartDate, new { @class = "datepicker" })
            </div>
            <div class="editor-label">
                Time
            </div>
            <div class="editor-field">
                @Html.TextBoxFor(m => m.ActiveStartTimeOfDay, new { @class = "timepicker" })
            </div>
        </div>

        <div id="Daily" class="section" hidden>
            <h5>Daily</h5>
            <div class="editor-label">
                Recurs every:
            </div>
            <div class="editor-field">
                @Html.TextBoxFor(m => m.FrequencyInterval, new { @type = "number", @class = "span4", @min = 1 }) day(s)
            </div>
        </div>

        <div id="Weekly" class="section" hidden>
            <h5>Weekly</h5>
            <div class="editor-label">
                Recurs every:
            </div>
            <div class="editor-field">
                @Html.TextBoxFor(m => m.FrequencyInterval, new { @type = "number", @class = "span4", @min = 1 }) week(s) on
            </div>
            <div class="editor-field">
                <table style="padding:10px;">
                    <tr>
                        <td>@Html.CheckBoxFor(m => m.Monday) Monday</td>
                        <td>@Html.CheckBoxFor(m => m.Tuesday) Tuesday</td>
                        <td>@Html.CheckBoxFor(m => m.Wednesday) Wednesday</td>
                        <td>@Html.CheckBoxFor(m => m.Thursday) Thursday</td>
                        <td>@Html.CheckBoxFor(m => m.Friday) Friday</td>
                        <td>@Html.CheckBoxFor(m => m.Saturday) Saturday</td>
                        <td>@Html.CheckBoxFor(m => m.Sunday) Sunday</td>
                    </tr>
                </table>
            </div>
        </div>


        <div id="Monthly" class="section" hidden>
            <h5>Monthly</h5>
            <div class="editor-label">
                Date
            </div>
            <div class="editor-field">

            </div>
            <div class="editor-label">
                Time
            </div>
            <div class="editor-field">

            </div>
        </div>

        <div id="MonthlyRelative" class="section" hidden>
            <h5>Monthly from</h5>
            <div class="editor-label">
                Date
            </div>
            <div class="editor-field">

            </div>
            <div class="editor-label">
                Time
            </div>
            <div class="editor-field">

            </div>
        </div>

        <div id="DailyFrequency" class="section" hidden>
            <h5>Daily frequency</h5>
            <div class="editor-label">
                Date
            </div>
            <div class="editor-field">

            </div>
            <div class="editor-label">
                Time
            </div>
            <div class="editor-field">

            </div>
        </div>

        <div id="Duration" class="section" hidden>
            <h5>Duration</h5>
            <div class="editor-label">
                Start Date
            </div>
            <div class="editor-field">
                @Html.TextBoxFor(m => m.ActiveStartDate, new { @class = "datepicker" })
            </div>
            <div class="editor-label">
                End Date
            </div>
            <div class="editor-field">
                @Html.CheckBox("NoEndDate") No end date
            </div>
            <div class="editor-field" id="enddate">
                @Html.TextBoxFor(m => m.ActiveEndDate, new { @class = "datepicker" })
            </div>
        </div>

        <div class="btn-block">
            <input type="submit" value="Update Schedule" class="myButton" />
        </div>
    </fieldset>
}

@if (TempData["message"] != null)
{
    <p>@Html.Encode(TempData["message"])</p>
}

@section Scripts {
    <script>
        $(document).ready(function () {
            toggleOptionalDisplay($("#freqtype").val());
        })
    </script>

    <script>
        $(document).ready(function () {
            $('.datepicker').datepicker({ dateFormat: 'dd-mm-yy', showButtonPanel: true });
        });
    </script>

    <script>
        $(document).ready(function () {
            $('.timepicker').timepicker({timeFormat: 'hh:mm:ss'});
        });
    </script>



    <script>
        function toggleOptionalDisplay(e) {
            if (e == "AutoStart" || e == "OnIdle") {
                $('#OneTime').hide();
                $('#Daily').hide();
                $('#Weekly').hide();
                $('#Monthly').hide();
                $('#MonthlyRelative').hide();
                $('#DailyFrequency').hide();
                $('#Duration').hide();
            }
            if (e == "OneTime") {
                $('#OneTime').show();
                $('#Daily').hide();
                $('#Weekly').hide();;
                $('#Monthly').hide();
                $('#MonthlyRelative').hide();
                $('#DailyFrequency').hide();
                $('#Duration').hide();
            }
            if (e == "Daily") {
                $('#OneTime').hide();
                $('#Daily').show();
                $('#Weekly').hide();
                $('#Monthly').hide();
                $('#MonthlyRelative').hide();
                $('#DailyFrequency').show();
                $('#Duration').show();
            }
            if (e == "Weekly") {
                $('#OneTime').hide();
                $('#Daily').hide();
                $('#Weekly').show();
                $('#Monthly').hide();
                $('#MonthlyRelative').hide();
                $('#DailyFrequency').show();
                $('#Duration').show();
            }
            if (e == "Monthly") {
                $('#OneTime').hide();
                $('#Daily').hide();
                $('#Weekly').hide();
                $('#Monthly').show();
                $('#MonthlyRelative').hide();
                $('#DailyFrequency').show();
                $('#Duration').show();
            }
            if (e == "MonthlyRelative") {
                $('#OneTime').hide();
                $('#Daily').hide();
                $('#Weekly').hide();
                $('#Monthly').hide();
                $('#MonthlyRelative').show();
                $('#DailyFrequency').show();
                $('#Duration').show();
            }
        }

    </script>

}


<style>
    .section {
        padding: 5px;
        border-color: black;
        border-bottom-style: solid;
        border-bottom-width: thin;
        border-left-style: solid;
        border-left-width: thin;
        border-right-style: solid;
        border-right-width: thin;
    }
</style>

<style>
    .myButton {
        -moz-box-shadow: inset 0px 1px 3px 0px #91b8b3;
        -webkit-box-shadow: inset 0px 1px 3px 0px #91b8b3;
        box-shadow: inset 0px 1px 3px 0px #91b8b3;
        background: -webkit-gradient(linear, left top, left bottom, color-stop(0.05, #768d87), color-stop(1, #6c7c7c));
        background: -moz-linear-gradient(top, #768d87 5%, #6c7c7c 100%);
        background: -webkit-linear-gradient(top, #768d87 5%, #6c7c7c 100%);
        background: -o-linear-gradient(top, #768d87 5%, #6c7c7c 100%);
        background: -ms-linear-gradient(top, #768d87 5%, #6c7c7c 100%);
        background: linear-gradient(to bottom, #768d87 5%, #6c7c7c 100%);
        filter: progid:DXImageTransform.Microsoft.gradient(startColorstr='#768d87', endColorstr='#6c7c7c',GradientType=0);
        background-color: #768d87;
        -moz-border-radius: 5px;
        -webkit-border-radius: 5px;
        border-radius: 5px;
        border: 1px solid #566963;
        display: inline-block;
        cursor: pointer;
        color: #ffffff;
        font-family: Arial;
        font-size: 15px;
        font-weight: bold;
        padding: 11px 23px;
        text-decoration: none;
        text-shadow: 0px -1px 0px #2b665e;
    }

        .myButton:hover {
            background: -webkit-gradient(linear, left top, left bottom, color-stop(0.05, #6c7c7c), color-stop(1, #768d87));
            background: -moz-linear-gradient(top, #6c7c7c 5%, #768d87 100%);
            background: -webkit-linear-gradient(top, #6c7c7c 5%, #768d87 100%);
            background: -o-linear-gradient(top, #6c7c7c 5%, #768d87 100%);
            background: -ms-linear-gradient(top, #6c7c7c 5%, #768d87 100%);
            background: linear-gradient(to bottom, #6c7c7c 5%, #768d87 100%);
            filter: progid:DXImageTransform.Microsoft.gradient(startColorstr='#6c7c7c', endColorstr='#768d87',GradientType=0);
            background-color: #6c7c7c;
        }

        .myButton:active {
            position: relative;
            top: 1px;
        }
</style>
